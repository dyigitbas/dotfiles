# yaml-language-server: $schema=https://aka.ms/configuration-dsc-schema/0.2
properties:
  configurationVersion: 0.2.0
  resources:
    - resource: PSDscResources/Script
      id: CustomizeTaskbar
      directives:
        description: Customize the Windows taskbar to only include Chrome, Teams, and Outlook
      settings:
        SetScript: |
          try {
              # Define the paths to the app shortcuts
              $chromePath = "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Google Chrome.lnk"
              $teamsPath = "C:\Program Files\WindowsApps\MSTeams_24137.2216.2931.2440_x64__8wekyb3d8bbwe"
              $outlookPath = "C:\Program Files\WindowsApps\Microsoft.OutlookForWindows_1.2024.717.400_x64__8wekyb3d8bbwe"
    
              # Check if the shortcuts exist
              if (-not (Test-Path $chromePath)) { throw "Chrome shortcut not found at $chromePath" }
              if (-not (Test-Path $teamsPath)) { throw "Teams shortcut not found at $teamsPath" }
              if (-not (Test-Path $outlookPath)) { throw "Outlook shortcut not found at $outlookPath" }
    
              # Unpin all apps from the taskbar
              $shell = New-Object -ComObject shell.application
              if ($shell -eq $null) { throw "Failed to create Shell.Application COM object" }
              
              $taskBar = $shell.Namespace("Shell:TaskBar")
              if ($taskBar -eq $null) { throw "Failed to access TaskBar namespace" }
              
              $taskBarItems = $taskBar.Items()
              
              foreach ($item in $taskBarItems) {
                  $item.InvokeVerb("unpin from taskbar")
              }
    
              # Pin specified apps to the taskbar
              $shell.NameSpace((Get-Item $chromePath).DirectoryName).ParseName((Get-Item $chromePath).Name).InvokeVerb('Pin to taskbar')
              $shell.NameSpace((Get-Item $teamsPath).DirectoryName).ParseName((Get-Item $teamsPath).Name).InvokeVerb('Pin to taskbar')
              $shell.NameSpace((Get-Item $outlookPath).DirectoryName).ParseName((Get-Item $outlookPath).Name).InvokeVerb('Pin to taskbar')
          } catch {
              Write-Error "An error occurred: $_"
              throw $_
          }
        GetScript: return $false
        TestScript: return $false


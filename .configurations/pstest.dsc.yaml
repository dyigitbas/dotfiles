# yaml-language-server: $schema=https://aka.ms/configuration-dsc-schema/0.2
properties:
  configurationVersion: 0.2.0
  resources:
    - resource: PSDscResources/Script
      id: CustomizeTaskbar
      directives:
        description: Customize the Windows taskbar to only include Chrome, Teams, and Outlook
      settings:
        SetScript: |
          # Define the paths to the app shortcuts
          $chromePath = "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Google Chrome.lnk"
          $teamsPath = "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Microsoft Teams.lnk"
          $outlookPath = "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Microsoft Office\Outlook.lnk"
    
          # Unpin all apps from the taskbar
          $shell = New-Object -ComObject shell.application
          $taskBar = $shell.Namespace("Shell:TaskBar")
          $taskBarItems = $taskBar.Items()
          
          foreach ($item in $taskBarItems) {
              $item.InvokeVerb("unpin from taskbar")
          }
    
          # Pin specified apps to the taskbar
          $shell = New-Object -ComObject Shell.Application
          $shell.NameSpace((Get-Item $chromePath).DirectoryName).ParseName((Get-Item $chromePath).Name).InvokeVerb('Pin to taskbar')
          $shell.NameSpace((Get-Item $teamsPath).DirectoryName).ParseName((Get-Item $teamsPath).Name).InvokeVerb('Pin to taskbar')
          $shell.NameSpace((Get-Item $outlookPath).DirectoryName).ParseName((Get-Item $outlookPath).Name).InvokeVerb('Pin to taskbar')
        GetScript: return $false
        TestScript: return $false

